(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{347:function(t,s,e){t.exports=e.p+"assets/img/hello-child_process.893d064f.png"},364:function(t,s,e){"use strict";e.r(s);var a=e(20),v=Object(a.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"vue-electron-混合开发并使用-node-js-遇到的一个坑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue-electron-混合开发并使用-node-js-遇到的一个坑"}},[t._v("#")]),t._v(" Vue + Electron 混合开发并使用 Node.js 遇到的一个坑")]),t._v(" "),a("h2",{attrs:{id:"场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#场景"}},[t._v("#")]),t._v(" 场景")]),t._v(" "),a("p",[t._v("曾经做过这么一个奇葩需求:"),a("br"),t._v("\n使用 "),a("code",[t._v("Vue")]),t._v(" + "),a("code",[t._v("Electron")]),t._v(" 混合开发并使用 "),a("code",[t._v("Node.js")]),t._v(" 子进程("),a("code",[t._v("child_process")]),t._v(")调用 "),a("code",[t._v(".NET Core")]),t._v(" 程序的一个项目. 于是乎就遇到了如下的坑记录于此.")]),t._v(" "),a("h2",{attrs:{id:"node-js-报错"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#node-js-报错"}},[t._v("#")]),t._v(" Node.js 报错")]),t._v(" "),a("p",[t._v("如果你使用 "),a("code",[t._v("Vue")]),t._v(" + "),a("code",[t._v("Electron")]),t._v(" 混合开发并且需要使用 "),a("code",[t._v("Node.js")]),t._v(" (如: "),a("code",[t._v("http")]),t._v(" "),a("code",[t._v("child_process")]),t._v("), 你很大概率会遇到类似如下的错误:")]),t._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),a("p",[t._v("Uncaught TypeError: http.createServer is not a function"),a("br"),t._v("\nOR"),a("br"),t._v("\nUncaught TypeError: spawn is not a function")])]),t._v(" "),a("p",[t._v("很明显, 这是因为 "),a("strong",[t._v("直接把 "),a("code",[t._v("Node")]),t._v(" 程序在浏览器运行")]),t._v(" 而报的错; 或许你没有这么做, 但是 "),a("code",[t._v("Vue")]),t._v(" 帮你这么做了, 确切的说是 "),a("code",[t._v("Webpack")]),t._v(" 帮你这么做了.")]),t._v(" "),a("h3",{attrs:{id:"测试环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试环境"}},[t._v("#")]),t._v(" 测试环境")]),t._v(" "),a("blockquote",[a("p",[t._v("Vue CLI = 3.7.0"),a("br"),t._v("\nElectron = 5.0.0"),a("br"),t._v("\nNode = 10.15.3")])]),t._v(" "),a("p",[t._v("默认情况下"),a("code",[t._v("Vue CLI")]),t._v(" 输出的资源本身就是供浏览器直接运行的, 所以才会出现这种情况.")]),t._v(" "),a("h3",{attrs:{id:"解决问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决问题"}},[t._v("#")]),t._v(" 解决问题")]),t._v(" "),a("p",[t._v("既然知道了原因是由于 "),a("code",[t._v("Vue CLI")]),t._v(" 使用了 "),a("code",[t._v("Webpack")]),t._v(" 打包出来了仅供浏览器运行的资源, 那么我们如何让 "),a("code",[t._v("Webpack")]),t._v(" 打包出供 "),a("code",[t._v("Node")]),t._v(" 服务器运行的资源呢?"),a("br"),t._v("\n很简单, 在基于 Vue CLI 3.0+ 的版本上, 在你的 Vue 项目根目录的 "),a("code",[t._v("vue.config.js")]),t._v(" (没有 "),a("code",[t._v("vue.config.js")]),t._v(" 的自行创建)里面添加如下高亮代码:")]),t._v(" "),a("h4",{attrs:{id:"vue-config-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue-config-js"}},[t._v("#")]),t._v(" vue.config.js")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    publicPath"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    configureWebpack"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        target"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'node-webkit'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("h2",{attrs:{id:"测试结果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试结果"}},[t._v("#")]),t._v(" 测试结果")]),t._v(" "),a("h3",{attrs:{id:"vue-cli-直接运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue-cli-直接运行"}},[t._v("#")]),t._v(" Vue CLI 直接运行")]),t._v(" "),a("p",[t._v("现在我直接在 Vue 运行调试发现还是报错, 这次的报错如下:")]),t._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),a("p",[t._v("Uncaught ReferenceError: require is not defined")])]),t._v(" "),a("p",[t._v("这次我管都不管它, 任由他报错, 因为经过上面对 "),a("code",[t._v("Webpack")]),t._v(" 的配置后, 我们得到的资源已经不适合浏览器直接运行了, 所以 "),a("code",[t._v("Vue CLI")]),t._v(" 直接调试肯定是有问题的.")]),t._v(" "),a("h3",{attrs:{id:"通过-electron-运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过-electron-运行"}},[t._v("#")]),t._v(" 通过 Electron 运行")]),t._v(" "),a("p",[a("code",[t._v("Electron")]),t._v(" 本身就允许使用 "),a("code",[t._v("Node")]),t._v("（作为后端）的, 所以我们用它来运行试试.")]),t._v(" "),a("p",[a("img",{attrs:{src:e(347),alt:"hello child_process"}})]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("成功了🎉🎉🎉")])]),t._v(" "),a("p",[t._v("现在可以愉快的使用 "),a("code",[t._v("Vue")]),t._v(" + "),a("code",[t._v("Electron")]),t._v(" 混合开发并使用 "),a("code",[t._v("Node.js")]),t._v(" 了😀.")])])}),[],!1,null,null,null);s.default=v.exports}}]);